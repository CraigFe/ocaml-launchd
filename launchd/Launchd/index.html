<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Launchd (launchd.Launchd)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">launchd</a> &#x00BB; Launchd</nav><h1>Module <code>Launchd</code></h1><p>Allow an application to be managed by launchd.</p><p>Launchd is a daemon managment system used on OS X. Launchd can listen for incoming connections on sockets and spawn your server on demand. This module allows your application to retrieve the listening sockets created by launchd.</p><p>Please read the following documents:</p><ol><li><a href="https://developer.apple.com/library/mac/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CreatingLaunchdJobs.html">Creating Launch Daemons and Agents</a></li><li><a href="https://developer.apple.com/library/mac/technotes/tn2083/_index.html">Apple Technical Note TN2083: Daemons and Agents</a></li></ol></header><dl><dt class="spec type" id="type-error"><a href="#type-error" class="anchor"></a><code><span class="keyword">type </span>error</code><span class="keyword"> = </span><code>[ </code><table class="variant"><tr id="type-error.Enoent" class="anchored"><td class="def constructor"><a href="#type-error.Enoent" class="anchor"></a><code><span class="keyword">| </span></code><code>`Enoent<span class="keyword"> of </span>string</code></td></tr><tr id="type-error.Esrch" class="anchored"><td class="def constructor"><a href="#type-error.Esrch" class="anchor"></a><code><span class="keyword">| </span></code><code>`Esrch</code></td></tr><tr id="type-error.Ealready" class="anchored"><td class="def constructor"><a href="#type-error.Ealready" class="anchor"></a><code><span class="keyword">| </span></code><code>`Ealready</code></td></tr></table><code> ]</code></dt></dl><dl><dt class="spec value" id="val-error_to_msg"><a href="#val-error_to_msg" class="anchor"></a><code><span class="keyword">val </span>error_to_msg : (<span class="type-var">'a</span>, <a href="index.html#type-error">error</a>) Stdlib.result <span>&#45;&gt;</span> (<span class="type-var">'a</span>, [ `Msg of string ]) Stdlib.result</code></dt><dt class="spec value" id="val-activate_socket"><a href="#val-activate_socket" class="anchor"></a><code><span class="keyword">val </span>activate_socket : string <span>&#45;&gt;</span> (Unix.file_descr list, <a href="index.html#type-error">error</a>) Stdlib.result</code></dt><dd><p><code>activate_socket name</code>: retrieve the file descriptors for the sockets associated with the given <code>name</code> in the .plist file. This should be called once per invocation; subsequent calls will fail with <code>`Ealready</code>.</p><p>For example, in the following .plist, <code>name</code> should be <code>&quot;Listener&quot;</code>:</p><pre><code class="ml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE plist PUBLIC &quot;-//Apple//DTD PLIST 1.0//EN&quot; &quot;http://www.apple.com/DTDs/PropertyList-1.0.dtd&quot;&gt;
&lt;plist version=&quot;1.0&quot;&gt;
&lt;dict&gt;
        &lt;key&gt;Label&lt;/key&gt;
        &lt;string&gt;org.recoil.dave.anotherd&lt;/string&gt;
        &lt;key&gt;ProgramArguments&lt;/key&gt;
        &lt;array&gt;
                &lt;string&gt;/path/to/binary&lt;/string&gt;
        &lt;/array&gt;
        &lt;key&gt;Sockets&lt;/key&gt;
        &lt;dict&gt;

                &lt;key&gt;Listener&lt;/key&gt;
                &lt;dict&gt;
                        &lt;key&gt;SockServiceName&lt;/key&gt;
                        &lt;string&gt;8081&lt;/string&gt;
                        &lt;key&gt;SockType&lt;/key&gt;
                        &lt;string&gt;stream&lt;/string&gt;
                        &lt;key&gt;SockFamily&lt;/key&gt;
                        &lt;string&gt;IPv4&lt;/string&gt;
                &lt;/dict&gt;
        &lt;/dict&gt;
&lt;/dict&gt;
&lt;/plist&gt;</code></pre><p>Please note that launchd may bind multiple sockets (e.g. one for IPv4 and another for IPv6) and so the application must handle all the sockets returned by the call.</p><p>Please note that this call is blocking.</p><p>This call fails with:</p><ul><li><code>`Enoent name</code> if <code>name</code> could not be found in the .plist.</li><li><code>`Esrch</code> if this process is not being managed by launchd (for example if it is running from a terminal).</li><li><code>`Ealready</code> if the socket has already been activated.</li></ul></dd></dl></div></body></html>